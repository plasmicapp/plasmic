// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`data tokens: page meta codegen should codegen correct metadata with data tokens 1`] = `
"
import { pageText as $dataTokens_3UYiE_pageText, pageCanonical as $dataTokens_3UYiE_pageCanonical, pageImage as $dataTokens_3UYiE_pageImage } from "./plasmic-data-tokens"; // plasmic-import: 3UYiEMfU3twU4iYSx86cub/dataTokens
/**
 * Platform-agnostic page metadata type.
 * Structurally compatible with Next.js Metadata and other meta frameworks.
 */
type PlasmicPageMetadata = {
  title?: string;
  description?: string;
  openGraph?: {
    title?: string;
    description?: string;
    images?: string[];
  };
  twitter?: {
    card?: "summary" | "summary_large_image";
    title?: string;
    description?: string;
    images?: string[];
  };
  alternates?: {
    canonical?: string;
  };
};




function mkPathFromRouteAndParams(
  route: string,
  params: Record<string, string | string[] | undefined>
) {
  if (!params) {
    return route;
  }
  let path = route;
  for (const [key, value] of Object.entries(params)) {
    if (typeof value === "string") {
      path = path.replace(\`[\${key}]\`, value);
    } else if (Array.isArray(value)) {
      if (path.includes(\`[[...\${key}]]\`)) {
        path = path.replace(\`[[...\${key}]]\`, value.join("/"));
      } else if (path.includes(\`[...\${key}]\`)) {
        path = path.replace(\`[...\${key}]\`, value.join("/"));
      }
    }
  }
  return path;
}

export interface GenerateMetadataProps {
  params?: Promise<Record<string, string | string[] | undefined>>;
  searchParams?: Promise<Record<string, string | string[] | undefined>>;
}

export async function makeAppRouterPageCtx({ params, searchParams }: GenerateMetadataProps) {
  const pageRoute = "/seo";
  const pageParams = (await params) ?? {};
  const pagePath = mkPathFromRouteAndParams(pageRoute, pageParams);

  const ctx = {
    pageRoute,
    pagePath,
    params: pageParams,
    query: (await searchParams) ?? {},
  };
  return ctx;
}

export async function generateMetadata(props: GenerateMetadataProps): Promise<PlasmicPageMetadata> {
  const { params, searchParams } = props;
  const metadata: PlasmicPageMetadata = {
    title: String($ctx.pagePath),
    description: String(\`\${ $dataTokens_3UYiE_pageText } - in a templated string\`),
    openGraph: {
      title: String($ctx.pagePath),
      description: String(\`\${ $dataTokens_3UYiE_pageText } - in a templated string\`),
      images: [$dataTokens_3UYiE_pageImage],
    },
    twitter: {
      card: "summary_large_image",
      title: String($ctx.pagePath),
      description: String(\`\${ $dataTokens_3UYiE_pageText } - in a templated string\`),
      images: [$dataTokens_3UYiE_pageImage],
    },
    alternates: { canonical: String($dataTokens_3UYiE_pageCanonical.url) },
  };
  return metadata;
}
"
`;
