// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import { useRRouteMatch } from "@/wab/client/cli-routes";
import { getRowIdentifierNode } from "@/wab/client/components/cms/CmsEntryDetails";
import {
  DefaultCmsEntryItemProps,
  PlasmicCmsEntryItem,
} from "@/wab/client/plasmic/plasmic_kit_cms/PlasmicCmsEntryItem";
import { ApiCmseRow, ApiCmsTable } from "@/wab/shared/ApiSchema";
import { APP_ROUTES } from "@/wab/shared/route/app-routes";
import { fillRoute } from "@/wab/shared/route/route";
import { HTMLElementRefOf } from "@plasmicapp/react-web";
import * as React from "react";
import { Link } from "react-router-dom";

export interface CmsEntryItemProps extends DefaultCmsEntryItemProps {
  row: ApiCmseRow;
  table: ApiCmsTable;
}

const formatter = new Intl.DateTimeFormat([], {
  dateStyle: "medium",
  timeStyle: "short",
});

function CmsEntryItem_(props: CmsEntryItemProps, ref: HTMLElementRefOf<"div">) {
  const { table, row, ...rest } = props;
  const match = useRRouteMatch(APP_ROUTES.cmsEntry);
  return (
    <PlasmicCmsEntryItem
      {...rest}
      root={{
        as: Link,
        props: {
          ref,
          to: fillRoute(APP_ROUTES.cmsEntry, {
            ...match!.params,
            rowId: row.id,
          }),
        },
      }}
      children={getRowIdentifierNode(table, row)}
      isActive={match?.params.rowId === row.id}
      details={formatter.format(new Date(row.updatedAt))}
      hasDraft={!!row.draftData}
    />
  );
}

const CmsEntryItem = React.forwardRef(CmsEntryItem_);
export default CmsEntryItem;
